{% extends 'base.html' %}

{% block title %}–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è - –ê–≥–µ–Ω—Ç—ã{% endblock %}

{% block extra_style %}
  <style>
    .delete-all-btn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 1000;
    }
  </style>
{% endblock %}

{% block content %}

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="alert alert-{{ 'success' if category == 'success' else category }} alert-dismissible fade show" role="alert">
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="–ó–∞–∫—Ä—ã—Ç—å"></button>
        </div>
      {% endfor %}
    {% endif %}
  {% endwith %}

  <div class="container py-5">
    <div class="card-table">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="mb-0">–°–ø–∏—Å–æ–∫ –∞–≥–µ–Ω—Ç–æ–≤</h2>
        <a href="{{ url_for('add_agent') }}" class="btn btn-success">–î–æ–±–∞–≤–∏—Ç—å –∞–≥–µ–Ω—Ç–∞</a>
      </div>

      <div class="mb-3">
        <form method="get" class="d-flex gap-2 align-items-center flex-wrap">
          <input type="text" name="search" class="form-control me-2" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏...">

          <select name="access" class="form-select" style="max-width: 200px;">
            <option value="">–í—Å–µ —É—Ä–æ–≤–Ω–∏</option>
            <option value="–°–µ–∫—Ä–µ—Ç–Ω–æ">–°–µ–∫—Ä–µ—Ç–Ω–æ</option>
            <option value="–°–æ–≤–µ—Ä—à–µ–Ω–Ω–æ —Å–µ–∫—Ä–µ—Ç–Ω–æ">–°–æ–≤–µ—Ä—à–µ–Ω–Ω–æ —Å–µ–∫—Ä–µ—Ç–Ω–æ</option>
            <option value="–û—Å–æ–±–æ–π –≤–∞–∂–Ω–æ—Å—Ç–∏">–û—Å–æ–±–æ–π –≤–∞–∂–Ω–æ—Å—Ç–∏</option>
          </select>

          <button type="submit" class="btn btn-outline-primary">–ò—Å–∫–∞—Ç—å</button>
        </form>
      </div>

      <table class="table table-hover">
        <thead class="table-light">
          <tr>
            <th>–ö–æ–¥–æ–≤–æ–µ –∏–º—è</th>
            <th>Email</th>
            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
          </tr>
        </thead>
        <tbody>
          {% for agent in agents %}
          <tr>
            <td>{{ agent.code_name }}</td>
            <td> <a href="{{ url_for('send_email', id=agent.id) }}">{{ agent.agent_email }}</a> </td>
            <td>
              <div class="btn-group btn-group-sm" role="group">
                <a href="{{ url_for('agent_profile', id=agent.id) }}" class="btn btn-outline-primary">–î–æ—Å—å–µ</a>
                <a href="{{ url_for('edit_agent', id=agent.id) }}" class="btn btn-outline-success">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                <a href="{{ url_for('delete_agent', id=agent.id) }}" class="btn btn-outline-danger" onclick="return confirm('–£–¥–∞–ª–∏—Ç—å –∞–≥–µ–Ω—Ç–∞?')">–£–¥–∞–ª–∏—Ç—å</a>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <a href="{{ url_for('delete_all_agents')}}" class="btn btn-danger delete-all-btn">–£–Ω–∏—á—Ç–æ–∂–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</a>
{% endblock %}
